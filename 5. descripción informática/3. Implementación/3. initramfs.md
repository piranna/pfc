### initramfs

La segunda capa del sistema es la encargada de montar el sistema de archivos de
los usuarios y crear un sistema de archivos raiz independiente para cada uno de
ellos. Tambien proporciona un ejecutable `/init` PID 1 minimo
([century](../../8. apéndices/2. colaboraciones con proyectos externos/node-century.html)),
cuya labor es únicamente servir de "red de seguridad" de los procesos que mueran
en el sistema para evitar que provoquen un Kernel Panic, delegando el resto de
tareas de un proceso *init* tipico (como por ejemplo el actuar como demonio del
sistema) para que la realice otro comando que se le proporcione como parametro,
o en su defecto en el ejecutable ubicado en `/sbin/init` (ubicación tradicional
del script de arranque en los sistemas UNIX). Este enfoque tambien ha sido
tenido en cuenta por otras [personas](http://ewontfix.com/14) en especial por la
polemica que rodea a [SystemD](http://www.freedesktop.org/wiki/Software/systemd)
y su diseño que incita a la centralización de todos los componentes basicos de
la administracion de los sistemas Linux mas populares, y a raiz de esto estan
surgiendo otros comandos *init* del sistema con una filosofia minimalista como
es el caso de [uinit](https://github.com/siblynx/uinit).

El montaje del sistema de archivos de los usuarios es realizado por el módulo
[nodeos-mount-filesystems](../../8. apéndices/2. 1. módulos propios/8. nodeos-mount-filesystems.html),
el cual es ejecutado en NodeOS por *century* como script de inicio por defecto
al estar apuntando `/sbin/init` a el. Este módulo tambien realiza algunas tareas
basicas del arranque del sistema como es el definir el `umask` del sistema de
forma que los nuevos archivos solo sean accesibles por su creador (*0066*) o la
eliminación de los módulos, archivos y ejecutables usados durante el arranque
del propio *initramfs* y que no van a ser necesarios durante el funcionamiento
normal del sistema para ahorrar memoria.

Por ultimo, la capa de *initramfs* tambien se encarga de compilar e incluir la
libreria `libfuse`, necesaria para que *nodeos-mount-filesystems* pueda montar
el sistema de archivos
[ExclFS](../../8. apéndices/1. módulos propios/ExclFS.html) sobre `/dev`
y permitir acceder a los usuarios a los dispositivos del sistema sin requerir
permisos de administrador. Obviamente *ExclFS* y por tanto `libfuse` no son unos
componentes fundamentales para el funcionamiento de NodeOS, sin embargo dicha
libreria es necesaria para poder hacer uso de `FUSE`, por lo que estos solo se
incluyen dentro de la imagen *initram* en caso de que el kernel recien generado
incorpore soporte para ello. La forma de detectarlo consiste simplemente en
comprobar si esta definido en la configuración del kernel en caso de estar ésta
disponible:

```bash
grep -q "CONFIG_FUSE_FS=y" $BAREBONES/obj/$CPU/linux/.config
HAS_FUSE=$?
```

En la configuracion de `libfuse` se ha desactivado la compilación de los
ejemplos, las librerias estaticas y las herramientas de apoyo como `fusermount`,
las cuales no son necesarias. Tambien se ha desactivado el soporte del fichero
`/etc/mtab` puesto que no tiene sentido en un sistema como NodeOS donde cada
usuario tiene su propio sistema de archivos raiz, no obstante se plantea el que
pueda usarse en el futuro un link simbolico a `/proc/mounts` tal como hace
Ubuntu y otros sistemas Linux.
